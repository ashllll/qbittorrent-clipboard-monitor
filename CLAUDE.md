# qBittorrent å‰ªè´´æ¿ç›‘æ§ä¸è‡ªåŠ¨åˆ†ç±»ä¸‹è½½å™¨

## å˜æ›´è®°å½• (Changelog)

- **2025-10-22**: å®Œæˆå…¨é¡¹ç›®æ–‡ä»¶æ‰«æï¼Œå·²ç”Ÿæˆå®Œæ•´æ¨¡å—æ–‡æ¡£å’Œå¯¼èˆªé¢åŒ…å±‘ç³»ç»Ÿ
- **2025-10-22**: åˆå§‹åŒ– AI ä¸Šä¸‹æ–‡æ–‡æ¡£ï¼Œå®Œæˆé¡¹ç›®æ¶æ„åˆ†æå’Œæ¨¡å—ç»“æ„æ¢³ç†
- **2025-08-17**: v2.1.0 é¡¹ç›®æ¸…ç†å’ŒREADMEé‡å†™ï¼Œä¿®å¤èµ„æºæ³„æ¼é—®é¢˜
- **2025-07-15**: v2.0.0 é‡å¤§æ€§èƒ½ä¼˜åŒ–ï¼Œç£åŠ›é“¾æ¥æå–é€Ÿåº¦æå‡2-3å€

## é¡¹ç›®æ„¿æ™¯

ğŸš€ **æ™ºèƒ½ç£åŠ›é“¾æ¥ç›‘æ§ä¸è‡ªåŠ¨åˆ†ç±»ä¸‹è½½å·¥å…·** - æ‰“é€ æœ€æ™ºèƒ½åŒ–çš„ç§å­ä¸‹è½½ç®¡ç†åŠ©æ‰‹ï¼Œé›†æˆ AI åˆ†ç±»ã€ç½‘é¡µçˆ¬è™«å’Œè‡ªåŠ¨åŒ–ç®¡ç†ï¼Œè®©æ•°å­—å†…å®¹ä¸‹è½½å˜å¾—ç®€å•è€Œé«˜æ•ˆã€‚

## æ¶æ„æ€»è§ˆ

### æ ¸å¿ƒæ¶æ„
- **å¼‚æ­¥é©±åŠ¨**: åŸºäº asyncio çš„é«˜æ€§èƒ½å¼‚æ­¥æ¶æ„
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„èŒè´£åˆ†ç¦»ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
- **AI æ™ºèƒ½åˆ†ç±»**: é›†æˆ DeepSeek AI æ¨¡å‹è¿›è¡Œç²¾å‡†å†…å®¹åˆ†ç±»
- **ç½‘é¡µçˆ¬è™«**: åŸºäº crawl4ai çš„ä¸“ä¸šç½‘é¡µå†…å®¹æŠ“å–
- **é…ç½®ç®¡ç†**: æ”¯æŒçƒ­åŠ è½½ã€å¤šæ ¼å¼ã€ç¯å¢ƒå˜é‡è¦†ç›–
- **é€šçŸ¥ç³»ç»Ÿ**: å¤šæ¸ é“é€šçŸ¥é›†æˆ

### æŠ€æœ¯æ ˆ
- **è¯­è¨€**: Python 3.9+
- **AI æ¨¡å‹**: DeepSeek, OpenAI GPT
- **çˆ¬è™«æ¡†æ¶**: crawl4ai
- **HTTP å®¢æˆ·ç«¯**: aiohttp
- **é…ç½®ç®¡ç†**: Pydantic + Dynaconf
- **Web æœåŠ¡**: FastAPI (å¯é€‰)

## æ¨¡å—ç»“æ„å›¾

```mermaid
graph TD
    A["(æ ¹) qBittorrent å‰ªè´´æ¿ç›‘æ§å™¨"] --> B["qbittorrent_monitor"];
    B --> C["core"];
    C --> D["AIåˆ†ç±»å™¨"];
    C --> E["å‰ªè´´æ¿ç›‘æ§"];
    C --> F["qBittorrentå®¢æˆ·ç«¯"];
    C --> G["ç½‘é¡µçˆ¬è™«"];
    B --> H["config"];
    H --> I["é…ç½®ç®¡ç†"];
    B --> J["utils"];
    J --> K["å·¥å…·å‡½æ•°"];
    B --> L["exceptions"];
    L --> M["å¼‚å¸¸å®šä¹‰"];
    A --> N["start.py - å¯åŠ¨å…¥å£"];
    A --> O["docs - é¡¹ç›®æ–‡æ¡£"];
    O --> P["architecture"];
    O --> Q["guides"];

    click D "./qbittorrent_monitor/ai_classifier.py/CLAUDE.md" "æŸ¥çœ‹ AIåˆ†ç±»å™¨ æ¨¡å—æ–‡æ¡£"
    click E "./qbittorrent_monitor/clipboard_monitor.py/CLAUDE.md" "æŸ¥çœ‹ å‰ªè´´æ¿ç›‘æ§ æ¨¡å—æ–‡æ¡£"
    click F "./qbittorrent_monitor/qbittorrent_client.py/CLAUDE.md" "æŸ¥çœ‹ qBittorrentå®¢æˆ·ç«¯ æ¨¡å—æ–‡æ¡£"
    click G "./qbittorrent_monitor/web_crawler.py/CLAUDE.md" "æŸ¥çœ‹ ç½‘é¡µçˆ¬è™« æ¨¡å—æ–‡æ¡£"
    click I "./qbittorrent_monitor/config.py/CLAUDE.md" "æŸ¥çœ‹ é…ç½®ç®¡ç† æ¨¡å—æ–‡æ¡£"
    click K "./qbittorrent_monitor/utils.py/CLAUDE.md" "æŸ¥çœ‹ å·¥å…·å‡½æ•° æ¨¡å—æ–‡æ¡£"
```

## æ¨¡å—ç´¢å¼•

| æ¨¡å—è·¯å¾„ | èŒè´£æè¿° | å…¥å£æ–‡ä»¶ | æ–‡æ¡£çŠ¶æ€ | æµ‹è¯•çŠ¶æ€ |
|---------|---------|---------|---------|---------|
| `start.py` | åº”ç”¨ç¨‹åºå¯åŠ¨å…¥å£ï¼Œä¾èµ–æ£€æŸ¥å’Œåˆå§‹åŒ– | `main()` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/` | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘åŒ… | `__init__.py` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/config.py` | é…ç½®ç®¡ç†ï¼Œæ”¯æŒçƒ­åŠ è½½å’Œå¤šæ ¼å¼ | `ConfigManager` | âœ… å·²åˆ†æ | âœ… éªŒè¯å®Œæ•´ |
| `qbittorrent_monitor/clipboard_monitor.py` | å‰ªè´´æ¿ç›‘æ§å’Œå†…å®¹æ£€æµ‹ | `ClipboardMonitor` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/qbittorrent_client.py` | qBittorrent API å®¢æˆ·ç«¯ | `QBittorrentClient` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/ai_classifier.py` | AI æ™ºèƒ½åˆ†ç±»å™¨ | `AIClassifier` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/web_crawler.py` | ç½‘é¡µçˆ¬è™«å’Œç§å­æ‰¹é‡ä¸‹è½½ | `WebCrawler` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/utils.py` | é€šç”¨å·¥å…·å‡½æ•° | å¤šä¸ªå·¥å…·å‡½æ•° | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/exceptions.py` | è‡ªå®šä¹‰å¼‚å¸¸ç±»å®šä¹‰ | å¼‚å¸¸ç±»å±‚æ¬¡ | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/performance_monitor.py` | æ€§èƒ½ç›‘æ§å’ŒæŒ‡æ ‡æ”¶é›† | `PerformanceMonitor` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/log_optimizer.py` | æ—¥å¿—ä¼˜åŒ–å’Œç»“æ„åŒ–æ—¥å¿— | `LogOptimizer` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `qbittorrent_monitor/main.py` | ä¸»åº”ç”¨ç¨‹åºç±» | `QBittorrentDownloadHelper` | âœ… å·²åˆ†æ | ğŸ”„ éœ€è¦æµ‹è¯• |
| `docs/` | é¡¹ç›®æ–‡æ¡£å’ŒæŒ‡å— | `README.md` | âœ… å·²åˆ†æ | âœ… æ–‡æ¡£å®Œæ•´ |

## è¿è¡Œä¸å¼€å‘

### å¿«é€Ÿå¯åŠ¨
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨ç›‘æ§
python start.py

# æŸ¥çœ‹å¸®åŠ©
python start.py --help
```

### å¼€å‘æ¨¡å¼
```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements-dev.txt

# ä»£ç æ ¼å¼åŒ–
black qbittorrent_monitor/

# ç±»å‹æ£€æŸ¥
mypy qbittorrent_monitor/

# è¿è¡Œæµ‹è¯•ï¼ˆå½“æµ‹è¯•æ–‡ä»¶å­˜åœ¨æ—¶ï¼‰
pytest tests/
```

## æµ‹è¯•ç­–ç•¥

### å½“å‰æµ‹è¯•çŠ¶æ€
- âŒ **å•å…ƒæµ‹è¯•**: ç¼ºå¤±ï¼ˆéœ€è¦è¡¥å……ï¼‰
- âŒ **é›†æˆæµ‹è¯•**: ç¼ºå¤±ï¼ˆéœ€è¦è¡¥å……ï¼‰
- âŒ **æ€§èƒ½æµ‹è¯•**: ç¼ºå¤±ï¼ˆéœ€è¦è¡¥å……ï¼‰
- âŒ **ç«¯åˆ°ç«¯æµ‹è¯•**: ç¼ºå¤±ï¼ˆéœ€è¦è¡¥å……ï¼‰

### å»ºè®®æµ‹è¯•è¦†ç›–
1. **é…ç½®ç®¡ç†æµ‹è¯•**: éªŒè¯é…ç½®åŠ è½½ã€éªŒè¯ã€çƒ­åŠ è½½
2. **AIåˆ†ç±»å™¨æµ‹è¯•**: Mock AI APIï¼Œæµ‹è¯•åˆ†ç±»é€»è¾‘
3. **å‰ªè´´æ¿ç›‘æ§æµ‹è¯•**: æµ‹è¯•å†…å®¹æ£€æµ‹å’Œé‡å¤å¤„ç†
4. **qBittorrentå®¢æˆ·ç«¯æµ‹è¯•**: Mock APIï¼Œæµ‹è¯•è¿æ¥å’Œæ“ä½œ
5. **ç½‘é¡µçˆ¬è™«æµ‹è¯•**: Mock crawl4aiï¼Œæµ‹è¯•çˆ¬å–é€»è¾‘
6. **å¼‚å¸¸å¤„ç†æµ‹è¯•**: æµ‹è¯•å„ç§é”™è¯¯åœºæ™¯
7. **æ€§èƒ½æµ‹è¯•**: æµ‹è¯•å¹¶å‘å¤„ç†å’Œèµ„æºç®¡ç†

## ç¼–ç è§„èŒƒ

### ä»£ç é£æ ¼
- **æ ¼å¼åŒ–**: Black (line-length=100)
- **ç±»å‹æ£€æŸ¥**: mypy (ä¸¥æ ¼æ¨¡å¼)
- **ä»£ç è´¨é‡**: flake8
- **æ–‡æ¡£**: æ‰€æœ‰å…¬å…± API éœ€è¦æœ‰è¯¦ç»†æ–‡æ¡£å­—ç¬¦ä¸²

### å‘½åçº¦å®š
- **ç±»å**: PascalCase (å¦‚ `ClipboardMonitor`)
- **å‡½æ•°å**: snake_case (å¦‚ `get_torrent_info`)
- **å¸¸é‡**: UPPER_SNAKE_CASE (å¦‚ `DEFAULT_TIMEOUT`)
- **æ–‡ä»¶å**: snake_case (å¦‚ `ai_classifier.py`)

### å¼‚æ­¥ç¼–ç¨‹
- ä½¿ç”¨ `async/await` è€Œéå›è°ƒ
- åˆç†ä½¿ç”¨ `asyncio.Lock()` é¿å…ç«æ€æ¡ä»¶
- é”™è¯¯å¤„ç†ä½¿ç”¨ `try/except` åŒ…è£¹å¼‚æ­¥æ“ä½œ
- èµ„æºæ¸…ç†ä½¿ç”¨ `async with` ä¸Šä¸‹æ–‡ç®¡ç†å™¨

### æ—¥å¿—è§„èŒƒ
- ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—æ ¼å¼
- æ—¥å¿—çº§åˆ«: DEBUG < INFO < WARNING < ERROR
- æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ API å¯†é’¥ï¼‰ä¸å¾—è®°å½•åˆ°æ—¥å¿—ä¸­
- æ€§èƒ½å…³é”®è·¯å¾„æ·»åŠ è¯¦ç»†çš„æ—¶é—´æˆ³

## AI ä½¿ç”¨æŒ‡å¼•

### AI æ¨¡å‹é›†æˆ
- **ä¸»è¦æ¨¡å‹**: DeepSeek (deepseek-chat)
- **å¤‡ç”¨æ¨¡å‹**: OpenAI GPT ç³»åˆ—
- **åˆ†ç±»ç­–ç•¥**: Few-shot å­¦ä¹  + å…³é”®è¯è§„åˆ™å›é€€
- **ç¼“å­˜æœºåˆ¶**: 24å°æ—¶ LRU ç¼“å­˜ï¼Œé¿å…é‡å¤è°ƒç”¨

### åˆ†ç±»æç¤ºè¯ä¼˜åŒ–
- è¯¦ç»†çš„åˆ†ç±»æè¿°å’Œå…³é”®è¯æç¤º
- Few-shot ç¤ºä¾‹æä¾›åˆ†ç±»å‚è€ƒ
- å¤„ç†è¾¹ç•Œæƒ…å†µå’Œæ­§ä¹‰å†…å®¹
- æ”¯æŒè‡ªå®šä¹‰åˆ†ç±»è§„åˆ™å’Œä¼˜å…ˆçº§

### æ€§èƒ½ä¼˜åŒ–
- è¯·æ±‚é€Ÿç‡é™åˆ¶é¿å… API é…é¢è€—å°½
- æŒ‡æ•°é€€é¿é‡è¯•æœºåˆ¶
- æœ¬åœ°ç¼“å­˜å‡å°‘ API è°ƒç”¨
- å¹¶å‘è¯·æ±‚æ§åˆ¶

## å…³é”®ä¾èµ–

### æ ¸å¿ƒä¾èµ–
- `aiohttp`: å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
- `pydantic`: æ•°æ®éªŒè¯å’Œè®¾ç½®ç®¡ç†
- `pyperclip`: å‰ªè´´æ¿è®¿é—®
- `openai`: AI æ¨¡å‹ API å®¢æˆ·ç«¯
- `crawl4ai`: ç½‘é¡µçˆ¬è™«æ¡†æ¶

### å¼€å‘ä¾èµ–
- `pytest`: æµ‹è¯•æ¡†æ¶
- `black`: ä»£ç æ ¼å¼åŒ–
- `mypy`: ç±»å‹æ£€æŸ¥
- `flake8`: ä»£ç è´¨é‡æ£€æŸ¥

## éƒ¨ç½²ä¸è¿ç»´

### ç¯å¢ƒè¦æ±‚
- Python 3.9+
- qBittorrent Web UI å·²å¯ç”¨
- ç½‘ç»œè¿æ¥ï¼ˆç”¨äº AI åˆ†ç±»å’Œç½‘é¡µçˆ¬å–ï¼‰

### é…ç½®ç®¡ç†
- æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–é…ç½®
- é…ç½®æ–‡ä»¶çƒ­é‡è½½
- å¤šç¯å¢ƒé…ç½®æ¨¡æ¿ï¼ˆå¼€å‘/ç”Ÿäº§/æµ‹è¯•ï¼‰
- é…ç½®éªŒè¯å’Œé”™è¯¯æç¤º

### ç›‘æ§å’Œæ—¥å¿—
- ç»“æ„åŒ–æ—¥å¿—è¾“å‡º
- æ€§èƒ½æŒ‡æ ‡ç›‘æ§
- é”™è¯¯ç»Ÿè®¡å’ŒæŠ¥å‘Š
- èµ„æºä½¿ç”¨æƒ…å†µè·Ÿè¸ª

## å¸¸è§é—®é¢˜è§£å†³

### é…ç½®ç›¸å…³
1. **qBittorrent è¿æ¥å¤±è´¥**: æ£€æŸ¥ Web UI æ˜¯å¦å¯ç”¨ï¼Œç½‘ç»œæ˜¯å¦é€šç•…
2. **AI åˆ†ç±»ä¸å·¥ä½œ**: éªŒè¯ API å¯†é’¥ï¼Œæ£€æŸ¥ç½‘ç»œè¿æ¥
3. **å‰ªè´´æ¿ç›‘æ§å¼‚å¸¸**: ç¡®ä¿ç³»ç»Ÿå‰ªè´´æ¿æœåŠ¡æ­£å¸¸

### æ€§èƒ½ç›¸å…³
1. **å†…å­˜ä½¿ç”¨è¿‡é«˜**: æ£€æŸ¥ç¼“å­˜é…ç½®ï¼Œå®šæœŸæ¸…ç†å†å²è®°å½•
2. **CPU å ç”¨è¿‡é«˜**: è°ƒæ•´ç›‘æ§é—´éš”ï¼Œä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼
3. **ç½‘ç»œè¯·æ±‚é¢‘ç¹**: å¯ç”¨ç¼“å­˜ï¼Œè°ƒæ•´é‡è¯•ç­–ç•¥

### åŠŸèƒ½ç›¸å…³
1. **åˆ†ç±»ä¸å‡†ç¡®**: è°ƒæ•´ AI æç¤ºè¯ï¼Œå¢åŠ å…³é”®è¯è§„åˆ™
2. **ç½‘é¡µçˆ¬å–å¤±è´¥**: æ£€æŸ¥ç›®æ ‡ç½‘ç«™å¯è®¿é—®æ€§ï¼Œè°ƒæ•´ User-Agent
3. **ç§å­ä¸‹è½½å¤±è´¥**: éªŒè¯ qBittorrent é…ç½®ï¼Œæ£€æŸ¥ç£ç›˜ç©ºé—´

## è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹
1. Fork é¡¹ç›®å¹¶åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
2. ç¼–å†™ä»£ç å¹¶æ·»åŠ æµ‹è¯•
3. è¿è¡Œä»£ç è´¨é‡æ£€æŸ¥
4. æäº¤ Pull Request

### ä»£ç æäº¤è§„èŒƒ
```
type(scope): description

[optional body]

[optional footer]
```

ç±»å‹ï¼šfeat, fix, docs, style, refactor, test, chore

### æ–‡æ¡£ç»´æŠ¤
- æ–°åŠŸèƒ½éœ€è¦æ›´æ–°ç›¸å…³æ–‡æ¡£
- API å˜æ›´éœ€è¦æ›´æ–°æ¥å£æ–‡æ¡£
- é…ç½®å˜æ›´éœ€è¦æ›´æ–°é…ç½®ç¤ºä¾‹

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ´»è·ƒå¼€å‘ä¸­çš„é¡¹ç›®ï¼Œå»ºè®®å®šæœŸæŸ¥çœ‹æ›´æ–°æ—¥å¿—å’Œæ–‡æ¡£å˜æ›´ã€‚